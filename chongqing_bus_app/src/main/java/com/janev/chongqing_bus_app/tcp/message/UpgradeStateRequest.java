package com.janev.chongqing_bus_app.tcp.message;

import android.text.TextUtils;

import com.janev.chongqing_bus_app.system.Cache;
import com.janev.chongqing_bus_app.utils.BytesUtils;

import java.nio.charset.Charset;

public class UpgradeStateRequest extends IRequest{

    private final String msgSerial;
    private final String type;
    private final String resourceId;

    private final String progress;
    private final String fileName;
    private final int downloadProgress;

    public UpgradeStateRequest(String msgSerial,String type,String resourceId,String progress,String fileName,int downloadProgress) {
        super("06");
        this.msgSerial = msgSerial;
        this.type = type;
        this.resourceId = resourceId;
        this.progress = progress;
        this.fileName = fileName;
        this.downloadProgress = downloadProgress;
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder
                .append("平台流水号：").append(this.msgSerial).append(",")
                .append("升级类型：").append(this.type).append(",")
                .append("资源ID：").append(this.resourceId).append(",")
                .append("升级进度：").append(this.progress).append(",")
                .append("文件名称：").append(this.fileName).append(",")
                .append("下载进度：").append(this.downloadProgress);
        d(stringBuilder.toString());
    }

    @Override
    protected String getTag() {
        return "升级状态通知";
    }

    @Override
    protected String getHexData() {
        String fileNameHex = BytesUtils.bytesToHex(fileName.getBytes(Charset.forName("gbk")));
        d("文件名称：" + fileName + " --- " + fileNameHex);

        String downloadProgressHex = Integer.toHexString(downloadProgress);
        if (downloadProgressHex.length() < 2) {
            downloadProgressHex = "0" + downloadProgressHex;
        }
        d("下载进度：" + downloadProgress + " --- " + downloadProgressHex);

        return this.msgSerial
                + type
                + resourceId
                + progress
                + MessageUtils.getLength(fileNameHex)
                + fileNameHex
                + downloadProgressHex;
    }
}

// 2828
// 0B
// 062201200000010139201700070ae2075f00010175b2a2a2a2a2a2a2a2a2a2a2a2a2a2043726173682048656164202a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a0a54696d65204f662043726173682020202020203a20323032325f31315f31372d30315f33375f34330a526f6d20496e666f20202020202020202020203a20526f6d496e666f7b6e616d653d676f6f676c652c2076657273696f6e3d73646b5f676f6f676c655f70686f6e655f7838362d75736572646562756720372e312e31206e7963203636393531353520746573742d6b6579737d0a446576696365204d616e7566616374757265723a20476f6f676c650a446576696365204d6f64656c202020202020203a20416e64726f69642053444b206275696c7420666f72207838360a416e64726f69642056657273696f6e202020203a20372e312e310a416e64726f69642053444b20202020202020203a2032350a4170702056657273696f6e4e616d65202020203a20312e310a4170702056657273696f6e436f6465202020203a20310a2a2a2a2a2a2a2a2a2a2a2a2a2a2043726173682048656164202a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a0a0a6a6176612e6c616e672e4e756d626572466f726d6174457863657074696f6e3a20466f7220696e70757420737472696e673a20222e36220a096174206a6176612e6c616e672e496e74656765722e7061727365496e7428496e74656765722e6a6176613a353130290a09617420636f6d2e6a616e65762e63686f6e6771696e675f6275735f6170702e7574696c732e42797465735574696c732e686578546f427974652842797465735574696c732e6a6176613a3637290a09617420636f6d2e6a616e65762e63686f6e6771696e675f6275735f6170702e7574696c732e42797465735574696c732e686578546f4279746541727261792842797465735574696c732e6a6176613a3839290a09617420636f6d2e6a616e65762e63686f6e6771696e675f6275735f6170702e7463702e6d6573736167652e4d6573736167655574696c732e676574424343284d6573736167655574696c732e6a6176613a313933290a09617420636f6d2e6a616e65762e63686f6e6771696e675f6275735f6170702e7463702e6d6573736167652e49526571756573742e6279746541727261792849526571756573742e6a6176613a3932290a09617420636f6d2e6a616e65762e63686f6e6771696e675f6275735f6170702e7463702e6d6573736167652e49526571756573742e73656e642849526571756573742e6a6176613a3736290a09617420636f6d2e6a616e65762e63686f6e6771696e675f6275735f6170702e7463702e6d6573736167652e6d6573736167655f7574696c732e506172616d7351756572794d6573736167655574696c732e717565727928506172616d7351756572794d6573736167655574696c732e6a6176613a3832290a09617420636f6d2e6a616e65762e63686f6e6771696e675f6275735f6170702e7463702e636c69656e742e43686f6e6771696e675632436c69656e742e7265736f6c766543616c6c6261636b2843686f6e6771696e675632436c69656e742e6a6176613a3933290a09617420636f6d2e6a616e65762e63686f6e6771696e675f6275735f6170702e7463702e7265736f6c76652e43686f6e6771696e6756325265736f6c7665722e7265736f6c76652843686f6e6771696e6756325265736f6c7665722e6a6176613a3335290a09617420636f6d2e6a616e65762e63686f6e6771696e675f6275735f6170702e7463702e636c69656e742e544350436c69656e742e6f6e536f636b6574526573706f6e736528544350436c69656e742e6a6176613a313835290a09617420636f6d2e6a616e65762e63686f6e6771696e675f6275735f6170702e65617379736f636b65742e636f6e6e656374696f6e2e646973706174636865722e536f636b6574416374696f6e4469737061746368657224342e72756e28536f636b6574416374696f6e446973706174636865722e6a6176613a313934290a09617420616e64726f69642e6f732e48616e646c65722e68616e646c6543616c6c6261636b2848616e646c65722e6a6176613a373531290a09617420616e64726f69642e6f732e48616e646c65722e64697370617463684d6573736167652848616e646c65722e6a6176613a3935290a09617420616e64726f69642e6f732e4c6f6f7065722e6c6f6f70284c6f6f7065722e6a6176613a313534290a09617420616e64726f69642e6170702e41637469766974795468726561642e6d61696e2841637469766974795468726561642e6a6176613a36313139290a096174206a6176612e6c616e672e7265666c6563742e4d6574686f642e696e766f6b65284e6174697665204d6574686f64290a09617420636f6d2e616e64726f69642e696e7465726e616c2e6f732e5a79676f7465496e6974244d6574686f64416e644172677343616c6c65722e72756e285a79676f7465496e69742e6a6176613a383836290a09617420636f6d2e616e64726f69642e696e7465726e616c2e6f732e5a79676f7465496e69742e6d61696e285a79676f7465496e69742e6a6176613a373736290a420C
